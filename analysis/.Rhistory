procent_death =
cov %>% group_by(status, vac_status) %>%
dplyr::summarise(n=n()) %>%
pivot_wider(names_from = status, values_from = n) %>%
mutate(case_fatality_per_100 = (D/(D+R))*100) %>%
mutate(vacinated = if_else(vac_status == "Vax", 1, 0)) %>%
select(-vac_status) %>%
tbl_summary(
by  = vacinated
) %>%
add_p()
procent_death
procent_death =
cov %>%
select(status, vac_status) %>%
mutate(case_fatality = ifelse(status == "R",0,1)) %>%
select(-status) %>%
tbl_summary(
by  = vac_status
) %>%
add_p()
procent_death
procent_death =
cov %>%
select(status, vac_status) %>%
mutate(case_fatality = ifelse(status == "R",0,1)) %>%
select(-status) %>%
tbl_summary(
by  = vac_status
) %>%
add_difference()
procent_death =
cov %>%
select(status, vac_status) %>%
mutate(case_fatality = ifelse(status == "R",0,1)) %>%
select(-status) %>%
tbl_summary(
by  = vac_status
) %>%
add_difference()
procent_death
hospitalis_D = cov %>%
filter(status== "D") %>%
dplyr::select(vac_status,wave,gender, age, hospital_treat) %>%
mutate(male = ifelse(gender=="M",1,0)) %>%
mutate(hospitalized = ifelse(hospital_treat=="Hospital",1,0)) %>%
mutate(vacinated = ifelse(vac_status =="Vax",1,0)) %>%
dplyr::select(age,wave,male,hospitalized,vacinated) %>%
tbl_summary(
by = wave,
statistic = list(all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)")) %>%
add_p() %>%
as_flex_table()
hospitalis_D
cov = cov %>%
mutate(comp_outcome = case_when(hospital_treat == "Home" ~ "Recovery",
status == "D" ~ "Death",
TRUE ~ "Hospitalized"))
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
prop_vacinated = prop)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(dif_vax_nonvax = (non_vac_prop-prop_vacinated)) %>%
select(province, comp_outcome,dif_vax_nonvax) %>%
pivot_wider(names_from = comp_outcome, values_from = dif_vax_nonvax) %>%
select(-Recovery) %>%
rename(case_fatality_dif= Death,
hospitalisation_dif = Hospitalized) %>%
flextable()
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
prop_vacinated = prop)
province_v
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(dif_vax_nonvax = (non_vac_prop-prop_vacinated)) %>%
select(province, comp_outcome,dif_vax_nonvax)
province_all
province_all = province_v %>%
inner_join(province_nv)
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop)
province_v
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop)
province_nv
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
mutate(patients = "Vacinated")
province_v
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
mutate(patients = "Not_vacinated")
province_nv
province_all = province_v %>%
inner_join(province_nv) %>%
province_all = province_v %>%
inner_join(province_nv)
province_all = province_v %>%
inner_join(province_nv)
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
mutate(patients = "Vacinated")
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
mutate(patients = "Not_vacinated")
province_all = province_v %>%
inner_join(province_nv)
flextable()
province_all
province_all
province_nv
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
mutate(patients = "Vacinated")
province_v
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_vax = Death,
hospitalized_freq_vax = Hospitalized)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_not_vax = Death,
hospitalized_freq_not_vax = Hospitalized)
province_all = province_v %>%
inner_join(province_nv)
flextable()
province_all
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_vax = Death,
hospitalized_freq_vax = Hospitalized)
province_v
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_not_vax = Death,
hospitalized_freq_not_vax = Hospitalized)
province_nv
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_vax = Death,
hospitalized_freq_vax = Hospitalized,
recovery_freq_vax=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_not_vax = Death,
hospitalized_freq_not_vax = Hospitalized,
recovery_freq_not_vax=Recovery)
province_all = province_v %>%
inner_join(province_nv)
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_vax = Death,
hospitalized_freq_vax = Hospitalized,
recovery_freq_vax=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_not_vax = Death,
hospitalized_freq_not_vax = Hospitalized,
recovery_freq_not_vax=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
flextable()
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_vax = Death,
hospitalized_freq_vax = Hospitalized,
recovery_freq_vax=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_not_vax = Death,
hospitalized_freq_not_vax = Hospitalized,
recovery_freq_not_vax=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
flextable()
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_v = Death,
hospitalized_freq_v = Hospitalized,
recovery_freq_v=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_nv = Death,
hospitalized_freq_nv = Hospitalized,
recovery_freq_nv=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_n - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(3, 3,2))
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_v = Death,
hospitalized_freq_v = Hospitalized,
recovery_freq_v=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_nv = Death,
hospitalized_freq_nv = Hospitalized,
recovery_freq_nv=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(3, 3,2))
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_v = Death,
hospitalized_freq_v = Hospitalized,
recovery_freq_v=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_nv = Death,
hospitalized_freq_nv = Hospitalized,
recovery_freq_nv=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(2,2,2))
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_v = Death,
hospitalized_freq_v = Hospitalized,
recovery_freq_v=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_nv = Death,
hospitalized_freq_nv = Hospitalized,
recovery_freq_nv=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv))
province_all
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
)
province_all
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable()
province_all
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(2,2,2))
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(3,2,2))
province_all
province_v = cov %>%
filter(vac_status == "Vax") %>%
freq_table(province,comp_outcome) %>%
rename(n_vacinated = n,
vac_prop = prop) %>%
select(-n_vacinated) %>%
pivot_wider(names_from = comp_outcome, values_from = vac_prop) %>%
rename(case_fatality_v = Death,
hospitalized_freq_v = Hospitalized,
recovery_freq_v=Recovery)
province_nv = cov %>%
filter(vac_status == "No_vax") %>%
freq_table(province,comp_outcome) %>%
rename(non_vax_n = n,
non_vac_prop = prop) %>%
select(-non_vax_n) %>%
pivot_wider(names_from = comp_outcome, values_from = non_vac_prop)%>%
rename(case_fatality_nv = Death,
hospitalized_freq_nv = Hospitalized,
recovery_freq_nv=Recovery)
province_all = province_v %>%
inner_join(province_nv) %>%
mutate(case_fatality = case_fatality_v - case_fatality_nv,
hospitalized_freq = case_fatality_v - case_fatality_nv,
) %>%
select(-c(recovery_freq_v,recovery_freq_nv)) %>%
flextable() %>%
add_header_row(values = c("","Vacinated", "Not vacinated", "Difference - Vac-Not_vac"), colwidths = c(1,2,2,2))
province_all
table_day_day = cov %>%
filter(time_to_event == 0) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
filter(time_to_event == 0) %>%
group_by(status) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
mutate(equal = if_else(time_to_event == 0, 1,0)) %>%
group_by(status) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
mutate(equal = if_else(time_to_event == 0, 1,0)) %>%
group_by(equal,status) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
filter(hospital_treat == "Hospital") %>%
mutate(equal = if_else(time_to_event == 0, 1,0)) %>%
group_by(equal,status) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
filter(hospital_treat == "Hospital") %>%
mutate(equal = if_else(time_to_event == 0, 1, 0)) %>%
filter(equal >= 0) %>%
group_by(equal,status) %>%
summarise(n = n())
table_day_day
table_day_day = cov %>%
filter(hospital_treat == "Hospital") %>%
mutate(equal = if_else(time_to_event == 0, 1, 0)) %>%
filter(equal >= 0) %>%
select(equal,status) %>%
tbl_summary(
by = status
) %>%
add_difference()
table_day_day
table_day_day = cov %>%
filter(hospital_treat == "Hospital") %>%
mutate(equal = if_else(time_to_event == 0, 1, 0)) %>%
filter(equal >= 0) %>%
rename(same_day = equal) %>%
select(same_day,status) %>%
tbl_summary(
by = same_day
) %>%
add_difference()
table_day_day = cov %>%
filter(hospital_treat == "Hospital") %>%
mutate(equal = if_else(time_to_event == 0, 1, 0)) %>%
filter(equal >= 0) %>%
rename(same_day = equal) %>%
select(same_day,status) %>%
tbl_summary(
by = same_day
) %>%
add_difference()
table_day_day
